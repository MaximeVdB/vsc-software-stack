easyblock = 'PythonBundle'

name = 'dice-ml'
version = '0.9'

homepage = 'https://interpret.ml/DiCE/'
description = """Diverse Counterfactual Explanations (DiCE) for ML"""

toolchain = {'name': 'foss', 'version': '2022a'}

dependencies = [
    ('Python', '3.10.4'),
    ('SciPy-bundle', '2022.05'),
    ('scikit-learn', '1.1.2'),
    ('tqdm', '4.64.0'),
    ('TensorFlow', '2.11.0'),
]

exts_defaultclass = 'PythonPackage'
exts_default_options = {
    'source_urls': [PYPI_SOURCE],
    'download_dep_fail': True,
    'use_pip': True,
}

local_hatchling_preinstallopts = "sed -i 's|packaging>=21.3|packaging>=20.9|g' PKG-INFO && "
local_hatchling_preinstallopts += "sed -i 's|packaging>=21.3|packaging>=20.9|g' src/hatchling/ouroboros.py && "

exts_list = [
    ('pathspec', '0.10.1', {
        'checksums': ['7ace6161b621d31e7902eb6b5ae148d12cfd23f4a249b9ffb6b9fee12084323d'],
    }),
    ('hatchling', '1.11.1', {
        'preinstallopts': local_hatchling_preinstallopts,
    }),
    ('hatch-fancy-pypi-readme', '22.8.0', {
        'sources': [{
            'download_filename': 'hatch_fancy_pypi_readme-%(version)s.tar.gz',
            'filename': '%(name)s-%(version)s.tar.gz'
        }],
        'checksums': ['da91282ca09601c18aded8e378daf8b578c70214866f0971156ee9bb9ce6c26a'],
    }),
    ('hatch-vcs', '0.3.0', {
        'sources': [{
            'download_filename': 'hatch_vcs-%(version)s.tar.gz',
            'filename': '%(name)s-%(version)s.tar.gz'
        }],
        'checksums': ['cec5107cfce482c67f8bc96f18bbc320c9aa0d068180e14ad317bbee5a153fee'],
    }),
    ('jsonschema', '4.17.3'),
    ('raiutils', '0.4.0'),
    (name, version, {
        'sources': ['dice_ml-%(version)s.tar.gz'],
    }),
]

sanity_check_paths = {
    'files': [],
    'dirs': ['lib/python%(pyshortver)s/site-packages/dice_ml']
}

moduleclass = 'bio'
