/apps/gent/RHEL8/haswell-ib/software/Python/3.10.4-GCCcore-11.3.0/lib/python3.10/site-packages/paramiko/transport.py:236: CryptographyDeprecationWarning: Blowfish has been deprecated
  "class": algorithms.Blowfish,
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 8
Rules claiming more threads will be scaled down.
Job stats:
job                  count    min threads    max threads
-----------------  -------  -------------  -------------
all                      1              1              1
convert_RDS_h5ad         5              1              1
embeddings               1              1              1
embeddings_single        7              1              1
integration_run_r        5              1              1
metrics                  1              1              1
metrics_single          13              1              1
total                   33              1              1

Select jobs to execute...

[Tue Feb 14 08:31:33 2023]
Job 21: 
        Metrics hvg=full_feature,method=combat,o_type=full,scaling=unscaled,scenario=test_data_r4
        output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/combat_full.csv
        
Reason: Missing output files: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/combat_full.csv


[Tue Feb 14 08:31:33 2023]
Job 38: 
        SAVE EMBEDDING
        Scenario: test_data_r4 unscaled full_feature
        Method: scanvi embed
        Input: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/scanvi.h5ad
        Output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/embeddings/unscaled/full_feature/scanvi_embed.csv /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/embeddings/unscaled/full_feature/scanvi_embed_batch.png /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/embeddings/unscaled/full_feature/scanvi_embed_labels.png
        
Reason: Missing output files: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/embeddings/unscaled/full_feature/scanvi_embed.csv


[Tue Feb 14 08:31:33 2023]
Job 23: 
        Metrics hvg=full_feature,method=scanorama,o_type=full,scaling=unscaled,scenario=test_data_r4
        output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanorama_full.csv
        
Reason: Missing output files: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanorama_full.csv


[Tue Feb 14 08:31:33 2023]
Job 25: 
        Metrics hvg=full_feature,method=scgen,o_type=full,scaling=unscaled,scenario=test_data_r4
        output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scgen_full.csv
        
Reason: Missing output files: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scgen_full.csv


[Tue Feb 14 08:31:33 2023]
Job 20: 
        Metrics hvg=full_feature,method=bbknn,o_type=knn,scaling=unscaled,scenario=test_data_r4
        output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/bbknn_knn.csv
        
Reason: Missing output files: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/bbknn_knn.csv


[Tue Feb 14 08:31:33 2023]
Job 22: 
        Metrics hvg=full_feature,method=scanorama,o_type=embed,scaling=unscaled,scenario=test_data_r4
        output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanorama_embed.csv
        
Reason: Missing output files: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanorama_embed.csv


[Tue Feb 14 08:31:33 2023]
Job 24: 
        Metrics hvg=full_feature,method=scanvi,o_type=embed,scaling=unscaled,scenario=test_data_r4
        output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanvi_embed.csv
        
Reason: Missing output files: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanvi_embed.csv


[Tue Feb 14 08:31:33 2023]
Job 26: 
        Metrics hvg=full_feature,method=scvi,o_type=embed,scaling=unscaled,scenario=test_data_r4
        output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scvi_embed.csv
        
Reason: Missing output files: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scvi_embed.csv

Options
    type:	knn
    batch_key:	batch
    label_key:	celltype
    assay:	expression
    organism:	mouse
    n_hvgs:	None
    setup:	bbknn_knn
    optimised clustering results:	/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/bbknn_knn_nmi.txt
reading adata before integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts'
    uns: 'iroot', 'log1p'
    layers: 'counts'
reading adata after integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts'
    uns: 'iroot', 'log1p', 'neighbors', 'pca'
    obsm: 'X_pca'
    varm: 'PCs'
    layers: 'counts'
    obsp: 'connectivities', 'distances'
reduce integrated data:
    HVG selection:	None
    compute neighbourhood graph:	False
    precompute PCA:	False
computing metrics
type:	knn
    ASW:	False
    NMI:	True
    ARI:	True
    PCR:	False
    cell cycle:	False
    iso lab F1:	True
    iso lab ASW:	False
    HVGs:	False
    kBET:	True
    LISI:	True
    Trajectory:	False
Clustering...
Traceback (most recent call last):
  File "/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/scripts/metrics/metrics.py", line 239, in <module>
    results = scib.me.metrics(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/metrics.py", line 293, in metrics
    res_max, nmi_max, nmi_all = opt_louvain(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/Deprecated/1.2.13-foss-2022a/lib/python3.10/site-packages/deprecated/classic.py", line 285, in wrapper_function
    return wrapped_(*args_, **kwargs_)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/clustering.py", line 203, in opt_louvain
    sc.tl.louvain(adata, resolution=res, key_added=cluster_key)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scanpy/1.9.1-foss-2022a/lib/python3.10/site-packages/scanpy/tools/_louvain.py", line 138, in louvain
    import louvain
ModuleNotFoundError: No module named 'louvain'
[Tue Feb 14 08:31:37 2023]
Error in rule metrics_single:
    jobid: 20
    input: data/adata_norm.h5ad, /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/bbknn.h5ad
    output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/bbknn_knn.csv
    shell:
        
        python scripts/metrics/metrics.py -u data/adata_norm.h5ad -i /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/bbknn.h5ad          -o /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/bbknn_knn.csv -m bbknn          -b batch -l celltype --type knn          --hvgs 0 --organism mouse --assay expression -v
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Options
    type:	full
    batch_key:	batch
    label_key:	celltype
    assay:	expression
    organism:	mouse
    n_hvgs:	None
    setup:	scgen_full
    optimised clustering results:	/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scgen_full_nmi.txt
reading adata before integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts'
    uns: 'iroot', 'log1p'
    layers: 'counts'
reading adata after integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts', '_scvi_batch', '_scvi_labels'
    uns: '_scvi_manager_uuid', '_scvi_uuid'
    obsm: 'corrected_latent', 'latent'
reduce integrated data:
    HVG selection:	None
    compute neighbourhood graph:	True on X_pca
    precompute PCA:	True
PCA
Nearest Neigbours
computing metrics
type:	full
    ASW:	True
    NMI:	True
    ARI:	True
    PCR:	True
    cell cycle:	True
    iso lab F1:	True
    iso lab ASW:	True
    HVGs:	True
    kBET:	True
    LISI:	True
    Trajectory:	False
Clustering...
Traceback (most recent call last):
  File "/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/scripts/metrics/metrics.py", line 239, in <module>
    results = scib.me.metrics(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/metrics.py", line 293, in metrics
    res_max, nmi_max, nmi_all = opt_louvain(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/Deprecated/1.2.13-foss-2022a/lib/python3.10/site-packages/deprecated/classic.py", line 285, in wrapper_function
    return wrapped_(*args_, **kwargs_)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/clustering.py", line 203, in opt_louvain
    sc.tl.louvain(adata, resolution=res, key_added=cluster_key)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scanpy/1.9.1-foss-2022a/lib/python3.10/site-packages/scanpy/tools/_louvain.py", line 138, in louvain
    import louvain
ModuleNotFoundError: No module named 'louvain'
Options
    type:	embed
    batch_key:	batch
    label_key:	celltype
    assay:	expression
    organism:	mouse
    n_hvgs:	None
    setup:	scanvi_embed
    optimised clustering results:	/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanvi_embed_nmi.txt
reading adata before integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts'
    uns: 'iroot', 'log1p'
    layers: 'counts'
reading adata after integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts'
    uns: 'iroot', 'log1p'
    obsm: 'X_emb'
    layers: 'counts'
reduce integrated data:
    HVG selection:	None
    compute neighbourhood graph:	True on X_emb
    precompute PCA:	True
PCA
Nearest Neigbours
computing metrics
type:	embed
    ASW:	True
    NMI:	True
    ARI:	True
    PCR:	True
    cell cycle:	True
    iso lab F1:	True
    iso lab ASW:	True
    HVGs:	False
    kBET:	True
    LISI:	True
    Trajectory:	False
Clustering...
Traceback (most recent call last):
  File "/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/scripts/metrics/metrics.py", line 239, in <module>
    results = scib.me.metrics(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/metrics.py", line 293, in metrics
    res_max, nmi_max, nmi_all = opt_louvain(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/Deprecated/1.2.13-foss-2022a/lib/python3.10/site-packages/deprecated/classic.py", line 285, in wrapper_function
    return wrapped_(*args_, **kwargs_)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/clustering.py", line 203, in opt_louvain
    sc.tl.louvain(adata, resolution=res, key_added=cluster_key)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scanpy/1.9.1-foss-2022a/lib/python3.10/site-packages/scanpy/tools/_louvain.py", line 138, in louvain
    import louvain
ModuleNotFoundError: No module named 'louvain'
Options
    type:	embed
    batch_key:	batch
    label_key:	celltype
    assay:	expression
    organism:	mouse
    n_hvgs:	None
    setup:	scvi_embed
    optimised clustering results:	/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scvi_embed_nmi.txt
reading adata before integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts'
    uns: 'iroot', 'log1p'
    layers: 'counts'
reading adata after integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts'
    uns: 'iroot', 'log1p'
    obsm: 'X_emb'
    layers: 'counts'
reduce integrated data:
    HVG selection:	None
    compute neighbourhood graph:	True on X_emb
    precompute PCA:	True
PCA
Nearest Neigbours
computing metrics
type:	embed
    ASW:	True
    NMI:	True
    ARI:	True
    PCR:	True
    cell cycle:	True
    iso lab F1:	True
    iso lab ASW:	True
    HVGs:	False
    kBET:	True
    LISI:	True
    Trajectory:	False
Clustering...
Traceback (most recent call last):
  File "/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/scripts/metrics/metrics.py", line 239, in <module>
    results = scib.me.metrics(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/metrics.py", line 293, in metrics
    res_max, nmi_max, nmi_all = opt_louvain(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/Deprecated/1.2.13-foss-2022a/lib/python3.10/site-packages/deprecated/classic.py", line 285, in wrapper_function
    return wrapped_(*args_, **kwargs_)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/clustering.py", line 203, in opt_louvain
    sc.tl.louvain(adata, resolution=res, key_added=cluster_key)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scanpy/1.9.1-foss-2022a/lib/python3.10/site-packages/scanpy/tools/_louvain.py", line 138, in louvain
    import louvain
ModuleNotFoundError: No module named 'louvain'
[Tue Feb 14 08:31:45 2023]
Error in rule metrics_single:
    jobid: 25
    input: data/adata_norm.h5ad, /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/scgen.h5ad
    output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scgen_full.csv
    shell:
        
        python scripts/metrics/metrics.py -u data/adata_norm.h5ad -i /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/scgen.h5ad          -o /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scgen_full.csv -m scgen          -b batch -l celltype --type full          --hvgs 0 --organism mouse --assay expression -v
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

[Tue Feb 14 08:31:46 2023]
Error in rule metrics_single:
    jobid: 24
    input: data/adata_norm.h5ad, /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/scanvi.h5ad
    output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanvi_embed.csv
    shell:
        
        python scripts/metrics/metrics.py -u data/adata_norm.h5ad -i /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/scanvi.h5ad          -o /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanvi_embed.csv -m scanvi          -b batch -l celltype --type embed          --hvgs 0 --organism mouse --assay expression -v
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

[Tue Feb 14 08:31:46 2023]
Error in rule metrics_single:
    jobid: 26
    input: data/adata_norm.h5ad, /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/scvi.h5ad
    output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scvi_embed.csv
    shell:
        
        python scripts/metrics/metrics.py -u data/adata_norm.h5ad -i /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/scvi.h5ad          -o /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scvi_embed.csv -m scvi          -b batch -l celltype --type embed          --hvgs 0 --organism mouse --assay expression -v
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Options
    type:	full
    batch_key:	batch
    label_key:	celltype
    assay:	expression
    organism:	mouse
    n_hvgs:	None
    setup:	combat_full
    optimised clustering results:	/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/combat_full_nmi.txt
reading adata before integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts'
    uns: 'iroot', 'log1p'
    layers: 'counts'
reading adata after integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts'
    uns: 'iroot', 'log1p'
    layers: 'counts'
reduce integrated data:
    HVG selection:	None
    compute neighbourhood graph:	True on X_pca
    precompute PCA:	True
PCA
Nearest Neigbours
computing metrics
type:	full
    ASW:	True
    NMI:	True
    ARI:	True
    PCR:	True
    cell cycle:	True
    iso lab F1:	True
    iso lab ASW:	True
    HVGs:	True
    kBET:	True
    LISI:	True
    Trajectory:	False
Clustering...
Traceback (most recent call last):
  File "/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/scripts/metrics/metrics.py", line 239, in <module>
    results = scib.me.metrics(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/metrics.py", line 293, in metrics
    res_max, nmi_max, nmi_all = opt_louvain(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/Deprecated/1.2.13-foss-2022a/lib/python3.10/site-packages/deprecated/classic.py", line 285, in wrapper_function
    return wrapped_(*args_, **kwargs_)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/clustering.py", line 203, in opt_louvain
    sc.tl.louvain(adata, resolution=res, key_added=cluster_key)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scanpy/1.9.1-foss-2022a/lib/python3.10/site-packages/scanpy/tools/_louvain.py", line 138, in louvain
    import louvain
ModuleNotFoundError: No module named 'louvain'
[Tue Feb 14 08:31:47 2023]
Error in rule metrics_single:
    jobid: 21
    input: data/adata_norm.h5ad, /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/combat.h5ad
    output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/combat_full.csv
    shell:
        
        python scripts/metrics/metrics.py -u data/adata_norm.h5ad -i /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/combat.h5ad          -o /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/combat_full.csv -m combat          -b batch -l celltype --type full          --hvgs 0 --organism mouse --assay expression -v
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Options
    type:	full
    batch_key:	batch
    label_key:	celltype
    assay:	expression
    organism:	mouse
    n_hvgs:	None
    setup:	scanorama_full
    optimised clustering results:	/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanorama_full_nmi.txt
reading adata before integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts'
    uns: 'iroot', 'log1p'
    layers: 'counts'
reading adata after integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts'
    obsm: 'X_emb', 'X_scanorama'
reduce integrated data:
    HVG selection:	None
    compute neighbourhood graph:	True on X_pca
    precompute PCA:	True
PCA
Nearest Neigbours
computing metrics
type:	full
    ASW:	True
    NMI:	True
    ARI:	True
    PCR:	True
    cell cycle:	True
    iso lab F1:	True
    iso lab ASW:	True
    HVGs:	True
    kBET:	True
    LISI:	True
    Trajectory:	False
Clustering...
Traceback (most recent call last):
  File "/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/scripts/metrics/metrics.py", line 239, in <module>
    results = scib.me.metrics(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/metrics.py", line 293, in metrics
    res_max, nmi_max, nmi_all = opt_louvain(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/Deprecated/1.2.13-foss-2022a/lib/python3.10/site-packages/deprecated/classic.py", line 285, in wrapper_function
    return wrapped_(*args_, **kwargs_)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/clustering.py", line 203, in opt_louvain
    sc.tl.louvain(adata, resolution=res, key_added=cluster_key)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scanpy/1.9.1-foss-2022a/lib/python3.10/site-packages/scanpy/tools/_louvain.py", line 138, in louvain
    import louvain
ModuleNotFoundError: No module named 'louvain'
Options
    type:	embed
    batch_key:	batch
    label_key:	celltype
    assay:	expression
    organism:	mouse
    n_hvgs:	None
    setup:	scanorama_embed
    optimised clustering results:	/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanorama_embed_nmi.txt
reading adata before integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts'
    uns: 'iroot', 'log1p'
    layers: 'counts'
reading adata after integration
AnnData object with n_obs × n_vars = 2730 × 3451
    obs: 'paul15_clusters', 'celltype', 'batch', 'n_counts'
    obsm: 'X_emb', 'X_scanorama'
reduce integrated data:
    HVG selection:	None
    compute neighbourhood graph:	True on X_emb
    precompute PCA:	True
PCA
Nearest Neigbours
computing metrics
type:	embed
    ASW:	True
    NMI:	True
    ARI:	True
    PCR:	True
    cell cycle:	True
    iso lab F1:	True
    iso lab ASW:	True
    HVGs:	False
    kBET:	True
    LISI:	True
    Trajectory:	False
Clustering...
Traceback (most recent call last):
  File "/kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/scripts/metrics/metrics.py", line 239, in <module>
    results = scib.me.metrics(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/metrics.py", line 293, in metrics
    res_max, nmi_max, nmi_all = opt_louvain(
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/Deprecated/1.2.13-foss-2022a/lib/python3.10/site-packages/deprecated/classic.py", line 285, in wrapper_function
    return wrapped_(*args_, **kwargs_)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib/1.1.1-foss-2022a/lib/python3.10/site-packages/scib/metrics/clustering.py", line 203, in opt_louvain
    sc.tl.louvain(adata, resolution=res, key_added=cluster_key)
  File "/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scanpy/1.9.1-foss-2022a/lib/python3.10/site-packages/scanpy/tools/_louvain.py", line 138, in louvain
    import louvain
ModuleNotFoundError: No module named 'louvain'
[Tue Feb 14 08:31:56 2023]
Error in rule metrics_single:
    jobid: 23
    input: data/adata_norm.h5ad, /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/scanorama.h5ad
    output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanorama_full.csv
    shell:
        
        python scripts/metrics/metrics.py -u data/adata_norm.h5ad -i /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/scanorama.h5ad          -o /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanorama_full.csv -m scanorama          -b batch -l celltype --type full          --hvgs 0 --organism mouse --assay expression -v
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

[Tue Feb 14 08:31:56 2023]
Error in rule metrics_single:
    jobid: 22
    input: data/adata_norm.h5ad, /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/scanorama.h5ad
    output: /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanorama_embed.csv
    shell:
        
        python scripts/metrics/metrics.py -u data/adata_norm.h5ad -i /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/integration/unscaled/full_feature/scanorama.h5ad          -o /kyukon/scratch/gent/vo/001/gvo00117/easybuild/RHEL8/haswell-ib/software/scib-pipeline/20221014-foss-2022a/pipeline/data/test_data_r4/metrics/unscaled/full_feature/scanorama_embed.csv -m scanorama          -b batch -l celltype --type embed          --hvgs 0 --organism mouse --assay expression -v
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Preparing dataset...
Nearest Neigbours
Calculating UMAP...
Saving embedding plot for labels "celltype"...
Saving embedding plot for batches "batch"...
Saving embedding coordinates...
[Tue Feb 14 08:31:59 2023]
Finished job 38.
1 of 33 steps (3%) done
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2023-02-14T083133.226088.snakemake.log
