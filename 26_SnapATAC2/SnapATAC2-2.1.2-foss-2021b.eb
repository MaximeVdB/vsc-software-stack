easyblock = 'Cargo'

name = 'SnapATAC2'
version = '2.1.2'

homepage = 'https://kzhang.org/SnapATAC2/'
description = """SnapATAC2 is the successor of the SnapATAC R package, featuring:
    - Faster and less memory usage, scale to >1M cells.
    - Improved dimension reduction and sampling algorithm.
"""

toolchain = {'name': 'foss', 'version': '2021b'}

builddependencies = [('Rust', '1.58.0')]

dependencies = [
    ('Python', '3.9.6'),
    # ('python-igraph', '0.9.8'),
    # ('scikit-learn', '1.0.2'),
    ('umap-learn', '0.5.3'),
    ('pyfaidx', '0.7.0'),
    ('tqdm', '4.62.3'),
    ('retworkx', '0.11.0'),
]

exts_defaultclass = 'PythonPackage'
exts_default_options = {
    'source_urls': [PYPI_SOURCE],
    'download_dep_fail': True,
    'use_pip': True,
    'sanity_pip_check': True,
    'installopts': '',
}

crates = [

]

exts_list = [
    # ('idna', '3.4', {
    #     'checksums': ['814f528e8dead7d329833b91c5faa87d60bf71824cd12a7530b5526063d02cb4'],
    # }),
    # ('natsort', '8.2.0', {
    #     'checksums': ['57f85b72c688b09e053cdac302dd5b5b53df5f73ae20b4874fcbffd8bf783d11'],
    # }),
    # # ('pandas', '1.5.1', {
    # #     'checksums': ['249cec5f2a5b22096440bd85c33106b6102e0672204abd2d5c014106459804ee'],
    # # }),
    # ('typing_extensions', '4.4.0', {
    #     'checksums': ['1511434bb92bf8dd198c12b1cc812e800d4181cfcb867674e0f8279cc93087aa'],
    # }),
    # ('setuptools', '65.5.0', {
    #     'checksums': ['512e5536220e38146176efb833d4a62aa726b7bbff82cfbc8ba9eaa3996e0b17'],
    # }),
    # ('setuptools-rust', '1.5.2', {
    #     'checksums': ['d8daccb14dc0eae1b6b6eb3ecef79675bd37b4065369f79c35393dd5c55652c7'],
    # }),
    # ('semantic_version', '2.10.0', {
    #     'checksums': ['bdabb6d336998cbb378d4b9db3a4b56a1e3235701dc05ea2690d9a997ed5041c'],
    # }),
    # ('tomli', '2.0.1', {
    #     'checksums': ['de526c12914f0c550d15924c62d72abc48d6fe7364aa87328337a31007fe8a4f'],
    # }),
    # ('maturin', '0.12.20', {
    #     'checksums': ['62ef15831f14330aa426c2ccc475c5b8d473bb52731e478e0cb9ab37e137d758'],
    # }),
    # ('plotly', '5.10.0', {
    #     'checksums': ['4d36d9859b7a153b273562deeed8c292587a472eb1fd57cd4158ec89d9defadb'],
    # }),
    # ('polars', '0.13.62', {
    #     'checksums': ['b66a5e37802c4e519b4ea63932bd42afe273046188de0e57373819860c8784fc'],
    # }),
    # ('pooch', '1.6.0', {
    #     'checksums': ['57d20ec4b10dd694d2b05bb64bc6b109c6e85a6c1405794ce87ed8b341ab3f44'],
    # }),
    # ('pyarrow', '9.0.0', {
    #     'checksums': ['7fb02bebc13ab55573d1ae9bb5002a6d20ba767bf8569b52fce5301d42495ab7'],
    # }),
    # # ('pynndescent', '0.5.7', {
    # #     'checksums': ['ecb395255fa36a748b5870b4ba0300ea0f7da8b1964864b8edd62577a84dfd7d'],
    # # }),
    # # ('retworkx', '0.11.0', {
    # #     'checksums': ['a4c2a5ad3f8402493d41ad20ad91a03777ea214a3636c290272bbfaf36161161'],
    # # }),
    # # to overwrite Python's requests requirement which requires older version of idna
    # ('requests', '2.28.1', {
    #     'checksums': ['7c5599b102feddaa661c826c56ab4fee28bfd17f5abca1ebbe3e7f19d7c97983'],
    # }),
    # # ('scipy', '1.9.3', {
    # #     'checksums': ['fbc5c05c85c1a02be77b1ff591087c83bc44579c6d2bd9fb798bb64ea5e1a027'],
    # # }),
    # # ('tenacity', '8.1.0', {
    # #     'checksums': ['e48c437fdf9340f5666b92cd7990e96bc5fc955e1298baf4a907e3972067a445'],
    # # }),
    # # ('texttable', '1.6.4', {
    # #     'checksums': ['42ee7b9e15f7b225747c3fa08f43c5d6c83bc899f80ff9bae9319334824076e9'],
    # # }),
    (name, version, {
        'extract_sources': True,
        'source_tmpl': 'snapatac2-%(version)s.tar.gz',
        'checksums': ['a717126f12fbb3862b5d8c40100f40fde857e6e890a4b086c64e3e623b0d90ec'],
    }),
]

extract_sources = True

build_cmd = 'find ../.. -type f -name "*.whl"'
install_cmd = 'find ../.. -type f -name "*.whl"'

sanity_check_commands = [
    "python -c 'from snapatac2 import datasets, genome, pl, pp, tl'",
]

moduleclass = 'bio'
